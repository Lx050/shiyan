# 微信公众号文章生成工具 - 产品需求文档 (V2.1)

## 版本更新记录

### V2.1 (当前版本)
- 优化小标题识别算法，提高识别准确率
- 增强图片注释识别能力，支持更多格式
- 修复图片注释显示问题，确保注释正确显示

### V2.0 
- 多模板库支持
- 批量处理队列
- 版本历史系统

### V1.2 
- 进一步改进小标题识别算法，提高对多个小标题的识别准确率
- 增强图片注释检测能力，支持更多格式的图片注释识别
- 优化内容结构分析逻辑，提高整体解析准确率

### V1.1 
- 修复文档解析过程中的"Could not find file in options"错误
- 改进小标题识别算法，提高识别准确率
- 优化图片占位符检测逻辑
- 完善模板选择机制，确保根据图片数量正确应用模板
- 修复图注显示问题，确保图注正确显示

### V1.0
- 实现基础功能：Word文档解析、内容识别、模板匹配、HTML生成
- 支持手动输入内容功能
- 实现微信公众号兼容的HTML输出

## 1. 项目概述

### 1.1 项目背景
随着微信公众号的普及，大量机构和个人需要频繁地将Word文档内容转换为微信公众号文章格式。传统手动复制粘贴方式效率低下，且难以保证格式统一。本项目旨在开发一个自动化工具，能够将Word文档快速转换为符合微信公众号格式要求的HTML文章。

### 1.2 产品定位
一款专门针对微信公众号平台优化的Word转HTML工具，通过智能解析文档结构并应用预设模板，实现一键生成符合微信公众号规范的文章内容。

### 1.3 目标用户
- 高校宣传部门
- 企业市场运营人员
- 自媒体内容创作者
- 新闻媒体编辑

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 Word文档解析引擎
- 支持.docx格式文档解析
- 自动提取文档中的文本内容和图片信息
- 识别文档结构（标题、正文、小标题、图片等）

#### 2.1.2 智能内容结构识别系统

##### 2.1.2.1 标题识别
- 基于字体大小、加粗样式和段落位置综合判断，默认为文档第一段

##### 2.1.2.2 正文识别
- 默认处理为正文段落，支持首行缩进

##### 2.1.2.3 小标题识别（V2.1优化）
- 长度限制：30字符以内
- 支持并列结构小标题识别（如"交流互鉴，共促志愿能力提升"）
- 扩展关键词库，增加志愿服务领域关键词
- 增强特殊模式匹配，提高识别准确率
- 支持上下文感知识别

##### 2.1.2.4 图片识别（V2.1增强）
- 支持"图+编号+描述"格式识别（如"图7 带领孩子们外出活动"）
- 增强正则表达式匹配，支持中文数字编号
- 支持全角空格分隔符
- 保留原始图片注释内容
- 正确显示所有图片的注释内容

#### 2.1.3 模板引擎
- 根据图片数量自动选择合适的模板：
  - 0-2张图片：优先使用单图模板或需要图注的双图布局
  - 3张及以上图片：使用无图注双图布局
- 支持手动修改：用户可调整自动匹配的模板类型

#### 2.1.4 多模板库支持（V2.0新增）
- 支持多种模板样式选择
- 商务风格模板
- 简约风格模板
- 教育风格模板
- 用户可自定义模板选择偏好

#### 2.1.5 批量处理队列（V2.0新增）
- 支持同时上传多个Word文档
- 队列式处理，依次生成HTML内容
- 批量下载生成结果
- 处理进度可视化展示

#### 2.1.6 版本历史系统（V2.0新增）
- 自动保存生成的HTML内容历史版本
- 支持查看、比较和恢复历史版本
- 版本备注功能
- 版本清理机制

#### 2.1.7 HTML生成器
- 生成符合微信公众号规范的内联样式HTML
- 使用固定的图片链接，确保内容一致性
- 支持微信公众号平台的兼容性要求

#### 2.1.8 实时预览窗口
- 提供电脑端和移动端预览效果
- 实时展示生成的HTML内容

#### 2.1.9 一键复制功能
- 可将生成的HTML复制到剪贴板
- 支持直接粘贴到微信公众号平台

#### 2.1.10 手动编辑功能
- 支持手动输入文字和选择图片类型
- 当自动解析失败时，提供备选输入方式

### 2.2 非功能需求

#### 2.2.1 性能要求
- 单篇文档处理时间不超过5秒
- 支持并发处理多个文档

#### 2.2.2 兼容性要求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 生成的HTML需完全兼容微信公众号平台

#### 2.2.3 安全性要求
- 不存储用户上传的文档
- 所有处理过程在用户本地浏览器完成

## 3. 产品原型设计

### 3.1 V1.0原型图
```
+------------------------------------------------------+
| 微信公众号文章生成工具 V1.0                         |
+------------------------------------------------------+
| [上传文档]  [手动输入]                              |
+------------------------------------------------------+
| +----------------------------------------------+ |
| | 预览区域                                     | |
| |                                              | |
| |  【标题】                                    | |
| |  ========                                    | |
| |                                              | |
| |  正文内容预览区域                            | |
| |                                              | |
| |  [图片占位符]                                | |
| |                                              | |
| |  [图片占位符]                                | |
| |                                              | |
| |  [生成文章] [手动编辑]                        | |
| +----------------------------------------------+ |
+------------------------------------------------------+

```


### 3.2 V2.0原型图

#### 3.2.1 多模板选择界面
```
+------------------------------------------------------+
| 微信公众号文章生成工具 V2.0                         |
+------------------------------------------------------+
| [上传文档]  [手动输入]                              |
+------------------------------------------------------+
| 模板选择: [● 商务风格] [○ 简约风格] [○ 教育风格]      |
|                                                  |
| +----------------------------------------------+ |
| | 预览区域                                     | |
| |                                              | |
| |  【标题】                                    | |
| |  ========                                    | |
| |                                              | |
| |  正文内容预览区域                            | |
| |                                              | |
| |  [图片占位符]                                | |
| |                                              | |
| |  [图片占位符]                                | |
| |                                              | |
| |  [保存模板偏好] [生成文章]                    | |
| +----------------------------------------------+ |
+------------------------------------------------------+
| 历史版本:                                        |
| 1. 文章A - 2023-05-01 10:30 [查看] [恢复]          |
| 2. 文章B - 2023-05-01 09:15 [查看] [恢复]          |
+------------------------------------------------------+
```

#### 3.2.2 批量处理界面
```
+------------------------------------------------------+
| 微信公众号文章生成工具 V2.0 - 批量处理              |
+------------------------------------------------------+
| [添加文档] [开始处理] [清空队列]                    |
+------------------------------------------------------+
| 处理队列:                                           |
| [●] 文档1.docx  [处理中] [====----] 60%             |
| [○] 文档2.docx  [等待中]                            |
| [○] 文档3.docx  [等待中]                            |
+------------------------------------------------------+
| 已完成:                                             |
| [√] 文档4.docx  [已完成] [查看] [下载]              |
| [√] 文档5.docx  [已完成] [查看] [下载]              |
+------------------------------------------------------+
```

#### 3.2.3 历史版本管理界面
```
+------------------------------------------------------+
| 微信公众号文章生成工具 V2.0 - 历史版本              |
+------------------------------------------------------+
| [返回] [清理历史]                                   |
+------------------------------------------------------+
| 搜索: [__________________________] [搜索]           |
+------------------------------------------------------+
| 日期       | 文档名称    | 模板类型  | 操作          |
|------------|------------|----------|---------------|
| 2023-05-01 | 文章A      | 商务风格  | [查看][恢复]   |
| 2023-05-01 | 文章B      | 简约风格  | [查看][恢复]   |
| 2023-04-30 | 文章C      | 教育风格  | [查看][恢复]   |
| 2023-04-30 | 文章D      | 商务风格  | [查看][恢复]   |
| 2023-04-29 | 文章E      | 简约风格  | [查看][恢复]   |
+------------------------------------------------------+
| [1] [2] [3] [4] [5] 页                              |
+------------------------------------------------------+
```

### 3.3 V2.1原型图

#### 3.3.1 小标题识别优化界面
```
+------------------------------------------------------+
| 微信公众号文章生成工具 V2.1                         |
+------------------------------------------------------+
| [上传文档]  [手动输入]                              |
+------------------------------------------------------+
| 识别结果预览:                                        |
|                                                      |
| 【标题】                                             |
| ========                                             |
|                                                      |
| 正文内容段落...                                     |
|                                                      |
| 【交流互鉴，共促志愿能力提升】 <-- 并列结构小标题     |
|                                                      |
| 正文内容段落...                                     |
|                                                      |
| 【初至特教中心，开启暖心志愿之旅】 <-- 并列结构小标题 |
|                                                      |
| [图7 带领孩子们外出活动] <-- 图片注释                |
|                                                      |
| [图8 孩子们的作品展示] <-- 图片注释                  |
+------------------------------------------------------+
| [保存] [预览] [复制HTML]                            |
+------------------------------------------------------+
```

#### 3.3.2 图片注释处理流程
```
文档解析阶段:
+------------------+     +------------------+     +------------------+
|   Word文档       | --> |  内容结构分析    | --> |  保留图注内容    |
+------------------+     +------------------+     +------------------+
                                |                         |
                                v                         v
                        +------------------+     +------------------+
                        | 识别图片注释类型 | --> | 存储在section中  |
                        +------------------+     +------------------+

模板处理阶段:
+------------------+     +------------------+     +------------------+
|  提取图注队列    | --> |  分配图注内容    | --> |  生成HTML显示    |
+------------------+     +------------------+     +------------------+

```


## 4. 架构设计蓝图

### 4.1 系统架构图 (V1.2更新)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              文档解析流程                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────┐    1.读取文档内容    ┌─────────────────────────┐  │
│  │ Word文档                │ ───────────────────→ │ documentParser服务      │  │
│  └─────────────────────────┘                      │ (src/services/          │  │
│                                                   │  documentParser.js)     │  │
│                                                   └─────────────────────────┘  │
│                                                            │                   │
│                                                            │ 2.分析内容结构    │
│                                                            ↓                   │
│  ┌─────────────────────────┐    3.识别小标题     ┌─────────────────────────┐  │
│  │ _isSubtitle方法          │ ←────────────────── │ _analyzeContentStructure│  │
│  │ (增强后)                │                     │ 方法                    │  │
│  └─────────────────────────┘                     └─────────────────────────┘  │
│           │                                                 │                   │
│           │ 4.返回判断结果                                  │                   │
│           ↓                                                 ↓                   │
│  ┌─────────────────────────┐    5.识别图片占位符 ┌─────────────────────────┐  │
│  │ _isImagePlaceholder方法  │ ←────────────────── │ _analyzeContentStructure│  │
│  │ (增强后)                │                     │ 方法                    │  │
│  └─────────────────────────┘                     └─────────────────────────┘  │
│           │                                                 │                   │
│           │ 6.返回判断结果                                  │                   │
│           ↓                                                 ↓                   │
│  ┌─────────────────────────┐    7.返回解析结果   ┌─────────────────────────┐  │
│  │ 解析后的内容结构         │ ←────────────────── │ documentParser服务      │  │
│  │ {title, sections}       │                     │                         │  │
│  └─────────────────────────┘                     └─────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          │ 8.传递给模板引擎
                                          ↓
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              模板引擎流程                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────┐    9.计算图片数量   ┌─────────────────────────┐  │
│  │ templateEngine服务      │ ───────────────────→ │ _selectTemplate方法     │  │
│  │ (src/services/          │                      │ (保持不变)              │  │
│  │  templateEngine.js)     │                      └─────────────────────────┘  │
│  └─────────────────────────┘                               │                   │
│           │                                                │ 10.选择模板       │
│           │                                                ↓                   │
│           │                                     ┌─────────────────────────┐    │
│           │                                     │ 模板类型                │    │
│           │                                     │ - double-image-with-    │    │
│           │                                     │   caption (1-2张图片)   │    │
│           │                                     │ - double-image-no-      │    │
│           │                                     │   caption (3+张图片)    │    │
│           │                                     │ - single-image (0张图片)│    │
│           │                                     └─────────────────────────┘    │
│           │                                                │                   │
│           │                                                │ 11.处理内容区块   │
│           │                                                ↓                   │
│           │                                     ┌─────────────────────────┐    │
│           │                                     │ _processContentSections │    │
│           │                                     │ 方法                    │    │
│           │                                     └─────────────────────────┘    │
│           │                                                │                   │
│           │                                                │ 12.生成HTML       │
│           │                                                ↓                   │
│           │                                     ┌─────────────────────────┐    │
│           │                                     │ 各种_get*Block方法       │    │
│           │                                     │ (包括图注处理)          │    │
│           │                                     └─────────────────────────┘    │
│           │                                                │                   │
│           │                                                │ 13.返回HTML       │
│           │                                                ↓                   │
│           │                                     ┌─────────────────────────┐    │
│           └────────────────────────────────────→│ 生成的HTML内容           │    │
│                                                 └─────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          │ 14.返回给前端
                                          ↓
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              前端显示流程                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────┐    15.显示内容     ┌─────────────────────────┐   │
│  │ 浏览器                  │ ←───────────────── │ 预览区域                │   │
│  └─────────────────────────┘                    │ (previewContent)        │   │
│                                                 └─────────────────────────┘   │
│           │                                                │                   │
│           │ 16.检查小标题和图注显示                      │                   │
│           ↓                                                ↓                   │
│  ┌─────────────────────────┐                     ┌─────────────────────────┐   │
│  │ 用户确认                │                     │ 正确显示的小标题和图注   │   │
│  └─────────────────────────┘                     └─────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 核心流程图

```
                    ┌─────────────┐
                    │  开始使用   │
                    └──────┬──────┘
                           │
              ┌────────────▼────────────┐
              │  上传Word文档或手动输入  │
              └────────────┬────────────┘
                           │
              ┌────────────▼────────────┐
              │    解析文档内容结构     │
              └────────────┬────────────┘
                           │
              ┌────────────▼────────────┐
              │   识别标题、正文、图片   │
              └────────────┬────────────┘
                           │
              ┌────────────▼────────────┐
              │    计算图片数量并选择    │
              │        合适模板         │
              └────────────┬────────────┘
                           │
              ┌────────────▼────────────┐
              │    生成HTML并预览       │
              └────────────┬────────────┘
                           │
              ┌────────────▼────────────┐
              │    复制HTML到剪贴板     │
              └────────────┬────────────┘
                           │
                    ┌──────▼──────┐
                    │  完成操作   │
                    └─────────────┘
```

### 4.3 组件交互说明

#### 4.3.1 文档解析组件
负责解析上传的Word文档，提取文本内容并识别文档结构。

#### 4.3.2 模板引擎组件
根据解析结果和图片数量选择合适的模板，并生成最终的HTML内容。

#### 4.3.3 手动编辑组件
当自动解析失败或用户需要自定义内容时，提供手动输入界面。

#### 4.3.4 错误处理模块 (V1.2保持不变)
- 增强的错误捕获和处理机制
- 详细的错误日志记录
- 用户友好的错误提示

## 5. 技术架构设计

### 5.1 系统架构图（V2.1更新）

```
                    +------------------+
                    |   用户浏览器      |
                    +------------------+
                             |
                    +------------------+
                    |   前端页面        |
                    | - 文档上传        |
                    | - 结果预览        |
                    | - HTML复制        |
                    +------------------+
                             |
        +-------------------------------------+
        |         后端服务 (Node.js)          |
        |-------------------------------------|
        |  API路由层                          |
        |  - /api/parse-document              |
        |  - /api/manual-content              |
        |  - /api/batch-process               |
        |  - /api/template                    |
        |  - /api/history                     |
        |-------------------------------------|
        |  业务逻辑层                         |
        |  - DocumentParser (增强)             |
        |    * 小标题识别优化                  |
        |    * 图片注释识别增强                |
        |  - TemplateEngine (增强)             |
        |    * 图注队列管理                   |
        |    * 图注正确显示                   |
        |  - BatchProcessor                   |
        |  - HistoryManager                   |
        |-------------------------------------|
        |  数据访问层                         |
        |  - TemplateRepository               |
        |  - HistoryRepository                |
        +-------------------------------------+
                             |
                    +------------------+
                    |   数据存储        |
                    | - 模板数据        |
                    | - 历史版本数据     |
                    +------------------+
```

### 5.2 核心模块设计（V2.1更新）

#### 5.2.1 文档解析器增强
- 小标题识别算法优化
- 图片注释识别能力增强
- 图注内容保留机制

#### 5.2.2 模板引擎增强
- 图注队列管理
- 图注正确分配和显示
- 向后兼容设计

#### 5.2.3 批量处理器（新增）
- 队列管理
- 并行处理控制
- 进度跟踪与状态更新

#### 5.2.4 历史管理器（新增）
- 版本存储与检索
- 版本比较功能
- 自动清理机制

## 6. 数据契约

### 6.1 API接口契约

#### 6.1.1 文档解析接口
- URL: `/api/parse-document`
- 方法: `POST`
- 请求参数:
  ```json
  {
    "document": "base64编码的文档数据"
  }
  ```
- 响应数据:
  ```json
  {
    "success": true,
    "data": {
      "title": "文章标题",
      "sections": [
        {
          "type": "text|image|subtitle",
          "content": "内容文本",
          "position": 1,
          "manualEdit": true|false  // 是否为手动编辑内容
        }
      ]
    }
  }
  ```

#### 6.1.2 手动输入接口
- URL: `/api/manual-content`
- 方法: `POST`
- 请求参数:
  ```json
  {
    "title": "文章标题",
    "sections": [
      {
        "type": "text|image|subtitle",
        "content": "内容文本",
        "position": 1,
        "manualEdit": true|false  // 是否为手动编辑内容
      }
    ]
  }
  ```
- 响应数据:
  ```json
  {
    "success": true,
    "data": {
      "title": "文章标题",
      "sections": [
        {
          "type": "text|image|subtitle",
          "content": "内容文本",
          "position": 1,
          "manualEdit": true|false  // 是否为手动编辑内容
        }
      ]
    }
  }
  ```

#### 6.1.3 批量处理接口（V2.0新增）
- URL: `/api/batch-process`
- 方法: `POST`
- 请求参数:
  ```json
  {
    "documents": [
      {
        "name": "文档1.docx",
        "data": "base64编码的文档数据"
      },
      {
        "name": "文档2.docx", 
        "data": "base64编码的文档数据"
      }
    ],
    "template": "business|simple|education"
  }
  ```
- 响应数据:
  ```json
  {
    "success": true,
    "data": {
      "taskId": "任务ID",
      "status": "processing|completed|failed",
      "results": [
        {
          "documentName": "文档1.docx",
          "status": "completed|failed",
          "htmlContent": "生成的HTML内容",
          "error": "错误信息（如果有）"
        }
      ]
    }
  }
  ```

#### 6.1.4 模板管理接口（V2.0新增）
- URL: `/api/templates`
- 方法: `GET`
- 响应数据:
  ```json
  {
    "success": true,
    "data": {
      "templates": [
        {
          "id": "business",
          "name": "商务风格",
          "preview": "模板预览HTML片段"
        },
        {
          "id": "simple", 
          "name": "简约风格",
          "preview": "模板预览HTML片段"
        },
        {
          "id": "education",
          "name": "教育风格", 
          "preview": "模板预览HTML片段"
        }
      ]
    }
  }
  ```

#### 6.1.5 历史版本接口（V2.0新增）
- URL: `/api/history`
- 方法: `GET`
- 响应数据:
  ```json
  {
    "success": true,
    "data": {
      "versions": [
        {
          "id": "版本ID",
          "documentName": "文档名称",
          "template": "使用的模板",
          "createdAt": "创建时间",
          "htmlContent": "HTML内容"
        }
      ]
    }
  }
  ```

#### 6.1.6 解析结果数据结构（V2.1更新）
- 类型定义:
  ```javascript
  /**
   * 解析后的内容结构
   * @typedef {Object} ParsedContent
   * @property {string} title - 文档标题
   * @property {Section[]} sections - 内容区块数组
   */

  /**
   * 内容区块
   * @typedef {Object} Section
   * @property {'text' | 'image' | 'subtitle'} type - 区块类型
   * @property {string} content - 区块内容
   * @property {number} position - 区块位置
   * @property {boolean} [manualEdit] - 是否为手动编辑内容
   */
  ```

- 更新说明:
  - `Section.content`字段对于[image](file:///C:/Users/Lx050/Desktop/%E6%8C%BA%E5%A5%BD%E6%8E%92%E7%89%88/src/types/index.js#L13-L13)类型现在包含原始图注内容
  - 小标题识别算法优化，提高识别准确率

## 7. 测试规范

### 7.1 功能测试用例

#### 7.1.1 文档解析测试
- 验证不同格式的Word文档能否正确解析
- 验证标题、正文、小标题、图片占位符能否正确识别

#### 7.1.2 模板匹配测试
- 验证0张图片时是否使用单图模板
- 验证1-2张图片时是否使用带图注双图模板
- 验证3张及以上图片时是否使用无图注双图模板

#### 7.1.3 HTML生成测试
- 验证生成的HTML是否符合微信公众号规范
- 验证样式是否正确应用

#### 7.1.4 手动编辑功能测试 (V1.2保持不变)
- 验证手动输入内容能否正确处理
- 验证手动选择的图片类型能否正确应用

### 7.2 性能测试用例
- 验证单篇文档处理时间不超过5秒
- 验证并发处理多个文档的稳定性

### 7.3 兼容性测试用例
- 验证在主流浏览器中的兼容性
- 验证生成的HTML在微信公众号平台的兼容性

## 8. 项目管理

### 8.1 迭代规划

#### V1.0 MVP (已完成)
- 实现基础的Word文档解析功能
- 实现基本的内容结构识别
- 实现简单的模板匹配和HTML生成
- 实现前端界面和基本交互

#### V1.1 优化迭代 (已完成)
- 修复文档解析错误
- 改进小标题识别算法
- 优化图片占位符检测
- 完善模板选择机制
- 修复图注显示问题

#### V1.2 进一步优化 (当前版本)
- 进一步改进小标题识别算法
- 增强图片注释检测能力
- 优化内容结构分析逻辑

#### V2.0 功能扩展（规划中）
- 多模板库支持
- 批量处理队列
- 版本历史系统

#### V3.0 高级功能（规划中）
- 自定义模板编辑器
- 云端素材库
- AI辅助内容优化

### 8.2 风险评估与应对

#### 8.2.1 技术风险
- Word文档格式兼容性问题
  - 应对：使用成熟的文档解析库，持续优化解析算法
  
- 模板匹配准确率问题
  - 应对：提供更多模板选择，支持手动调整

#### 8.2.2 业务风险
- 用户接受度不高
  - 应对：持续收集用户反馈，优化用户体验

#### 8.2.3 运维风险
- 服务器性能问题
  - 应对：优化代码性能，合理配置服务器资源

### 8.3 部署方案
- 前端采用静态部署方式
- 无后端服务器，所有处理在用户浏览器中完成
- 支持部署到CD+---------------------------------------------------------------+
|                  微信公众号文章生成工具                       |
+---------------------------------------------------------------+
|                                                               |
|  [点击或拖拽Word文档到此处上传]                               |
|                                                               |
|  [解析文档] [手动输入] [模板管理] [复制HTML]                  |
|                                                               |
+---------------------------------------------------------------+
|                  模板管理面板 (展开状态)                      |
+---------------------------------------------------------------+
| 模板名称: [_________________________]                         |
| 模板ID:   [_________________________]                         |
| 模板描述: [_________________________]                         |
|                                                               |
| 基础模板: [商务风格 v]                                        |
| 图片处理规则: [商务风格规则 v]                                |
|                                                               |
| +-----------------------------------------------------------+ |
| | 基础模板样式配置:                                         | |
| |                                                           | |
| | 小标题样式:                                               | |
| | [识别并应用小标题样式]                                    | |
| |                                                           | |
| | <section style="margin: 10px auto; background-color:      | |
| | #e8efbe; padding: 4px; border-radius: 25px;               | |
| | box-sizing:border-box;">                                  | |
| |   <section style="border: 1px dashed #bdc325;             | |
| |   border-radius: 25px; padding: 8px 15px;                 | |
| |   background-color: #ffffff; box-sizing:border-box;">     | |
| |     <section style="display: flex; align-items: center;   | |
| |     justify-content: space-between;">                     | |
| |       <section style="flex-shrink: 0;">                   | |
| |         <section class="assistant" style="width: 15px;">  | |
| |           <svg>...</svg>                                  | |
| |         </section>                                        | |
| |       </section>                                          | |
| |       <section>                                           | |
| |         <section style="font-size: 16px; color: #3f3f3f;  | |
| |         text-align: center; padding: 0 10px;">            | |
| |           <strong class="135brush">小标题</strong>         | |
| |         </section>                                        | |
| |       </section>                                          | |
| |       <section style="flex-shrink: 0;">                   | |
| |         <section class="assistant" style="width: 15px;">  | |
| |           <svg>...</svg>                                  | |
| |         </section>                                        | |
| |       </section>                                          | |
| |     </section>                                            | |
| |   </section>                                              | |
| | </section>                                                | |
| |                                                           | |
| | 正文样式:                                                 | |
| | [识别并应用正文样式]                                      | |
| |                                                           | |
| | <section style="background-color: #f9fcee; padding: 20px  | |
| | 15px;">                                                   | |
| |   <section class="135brush" style="text-align: justify;   | |
| |   line-height: 1.75em; letter-spacing: 1.5px;             | |
| |   font-size: 14px; color: #333333;">                      | |
| |     <p style="text-indent: 2.2em; margin-bottom: 5px;">   | |
| |       <span style="font-family: 微软雅黑;">正文</span>     | |
| |     </p>                                                  | |
| |   </section>                                              | |
| | </section>                                                | |
| +-----------------------------------------------------------+ |
|                                                               |
| [创建模板]                                                    |
|                                                               |
| 现有模板列表:                                                 |
| +-----------------------------------------------------------+ |
| | 商务风格 (内置模板)                                       | |
| | 适用于商务类文章的模板风格                                | |
| | ID: business                                              | |
| | [无法删除]                                                | |
| +-----------------------------------------------------------+ |
| +-----------------------------------------------------------+ |
| | 自定义模板1 (自定义)                                      | |
| | 用户自定义的模板                                          | |
| | ID: custom1                                               | |
| | [删除]                                                    | |
| +-----------------------------------------------------------+ |
+---------------------------------------------------------------++---------------------------------------------------------------+
|                  微信公众号文章生成工具                       |
+---------------------------------------------------------------+
|                                                               |
|  [点击或拖拽Word文档到此处上传]                               |
|                                                               |
|  [解析文档] [手动输入] [模板管理] [复制HTML]                  |
|                                                               |
+---------------------------------------------------------------+
|                  模板管理面板 (展开状态)                      |
+---------------------------------------------------------------+
| 模板名称: [_________________________]                         |
| 模板ID:   [_________________________]                         |
| 模板描述: [_________________________]                         |
|                                                               |
| 基础模板: [商务风格 v]                                        |
| 图片处理规则: [商务风格规则 v]                                |
|                                                               |
| +-----------------------------------------------------------+ |
| | 基础模板样式配置:                                         | |
| |                                                           | |
| | 小标题样式:                                               | |
| | [识别并应用小标题样式]                                    | |
| |                                                           | |
| | <section style="margin: 10px auto; background-color:      | |
| | #e8efbe; padding: 4px; border-radius: 25px;               | |
| | box-sizing:border-box;">                                  | |
| |   <section style="border: 1px dashed #bdc325;             | |
| |   border-radius: 25px; padding: 8px 15px;                 | |
| |   background-color: #ffffff; box-sizing:border-box;">     | |
| |     <section style="display: flex; align-items: center;   | |
| |     justify-content: space-between;">                     | |
| |       <section style="flex-shrink: 0;">                   | |
| |         <section class="assistant" style="width: 15px;">  | |
| |           <svg>...</svg>                                  | |
| |         </section>                                        | |
| |       </section>                                          | |
| |       <section>                                           | |
| |         <section style="font-size: 16px; color: #3f3f3f;  | |
| |         text-align: center; padding: 0 10px;">            | |
| |           <strong class="135brush">小标题</strong>         | |
| |         </section>                                        | |
| |       </section>                                          | |
| |       <section style="flex-shrink: 0;">                   | |
| |         <section class="assistant" style="width: 15px;">  | |
| |           <svg>...</svg>                                  | |
| |         </section>                                        | |
| |       </section>                                          | |
| |     </section>                                            | |
| |   </section>                                              | |
| | </section>                                                | |
| |                                                           | |
| | 正文样式:                                                 | |
| | [识别并应用正文样式]                                      | |
| |                                                           | |
| | <section style="background-color: #f9fcee; padding: 20px  | |
| | 15px;">                                                   | |
| |   <section class="135brush" style="text-align: justify;   | |
| |   line-height: 1.75em; letter-spacing: 1.5px;             | |
| |   font-size: 14px; color: #333333;">                      | |
| |     <p style="text-indent: 2.2em; margin-bottom: 5px;">   | |
| |       <span style="font-family: 微软雅黑;">正文</span>     | |
| |     </p>                                                  | |
| |   </section>                                              | |
| | </section>                                                | |
| +-----------------------------------------------------------+ |
|                                                               |
| [创建模板]                                                    |
|                                                               |
| 现有模板列表:                                                 |
| +-----------------------------------------------------------+ |
| | 商务风格 (内置模板)                                       | |
| | 适用于商务类文章的模板风格                                | |
| | ID: business                                              | |
| | [无法删除]                                                | |
| +-----------------------------------------------------------+ |
| +-----------------------------------------------------------+ |
| | 自定义模板1 (自定义)                                      | |
| | 用户自定义的模板                                          | |
| | ID: custom1                                               | |
| | [删除]                                                    | |
| +-----------------------------------------------------------+ |
+---------------------------------------------------------------+N，提高访问速度